<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.magee.system.mapper.SysUserRoleMapper">
    <select id="selectUserByRoleId" resultType="com.magee.system.domain.SysUser">
       select   u.*   from sys_user u
        <!-- 条件片段 -->
        ${ew.customSqlSegment}
        <if test="ew.emptyOfWhere">
            WHERE EXISTS (SELECT 1 FROM sys_user_role r where u.user_id = r.user_id and r.role_id = #{roleId})
            AND u.deleted = 0
        </if>
        <if test="!ew.emptyOfWhere">
            AND EXISTS (SELECT 1 FROM sys_user_role r where u.user_id = r.user_id and r.role_id = #{roleId})
            AND u.deleted = 0
        </if>
    </select>

    <select id="selectRoleByUserId" resultType="com.magee.system.domain.SysRole">
        select   r.*  from sys_role r
        <!-- 条件片段 -->
        ${ew.customSqlSegment}
        <if test="ew.emptyOfWhere">
            WHERE EXISTS (SELECT  * FROM sys_user_role u where u.role_id = r.role_id AND u.user_id = #{userId})
            AND r.deleted = 0
        </if>
        <if test="!ew.emptyOfWhere">
            AND EXISTS (SELECT  * FROM sys_user_role u where u.role_id = r.role_id AND u.user_id = #{userId})
            AND r.deleted = 0
        </if>
    </select>

</mapper>
